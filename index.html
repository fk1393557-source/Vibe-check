<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>For You ‚ú®</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&family=Inter:wght@400;600&display=swap" rel="stylesheet">

    <style>
        :root {
            --bg: #fdf6f0;
            --text: #5c4d42;
            --paper-lines: rgba(92, 77, 66, 0.08);
            --primary: #d4a373;
            --sticker-front: #fffcf2;
            --sticker-back: #f4e4bc;
        }

        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%;
            background-color: var(--bg);
            background-image: linear-gradient(var(--paper-lines) 1px, transparent 1px);
            background-size: 100% 35px;
            font-family: 'Inter', sans-serif;
            overflow: hidden; touch-action: none;
            transition: background 1s;
            cursor: none; 
        }

        /* --- üñçÔ∏è DOODLE CURSOR --- */
        #doodle-cursor {
            position: fixed; top: 0; left: 0; width: 28px; height: 28px;
            pointer-events: none; z-index: 9999;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='28' height='28' viewBox='0 0 24 24'%3E%3Cpath fill='%23ffffff' stroke='%23000000' stroke-width='2' stroke-linecap='round' stroke-linejoin='round' d='M5 3l6.5 17.5l2.5-7.5l7.5-2.5l-16.5-7.5z'/%3E%3C/svg%3E");
            background-size: contain; background-repeat: no-repeat;
            transform-origin: top left;
            animation: breathe-cursor 2s ease-in-out infinite;
        }
        @media (pointer: coarse) {
            #doodle-cursor { display: none !important; }
            body, html { cursor: auto; } 
        }
        @keyframes breathe-cursor { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.08); } }
        #doodle-cursor.hovering { animation: none; transform: rotate(-15deg) scale(1.1); filter: drop-shadow(2px 2px 2px rgba(0,0,0,0.1)); }
        #doodle-cursor.clicking { transform: scale(0.9); }
        button, .sticker, .tool-btn, .main-menu-btn, .option-sticker, .credits-btn, .nav-btn, a { cursor: none !important; }

        /* --- CURSOR TRAIL --- */
        .cursor-trail {
            position: fixed; pointer-events: none;
            width: 6px; height: 6px;
            background: #d4a373; border-radius: 50%;
            z-index: 9998; opacity: 0.8;
            animation: fadeTrail 0.8s ease-out forwards;
        }
        @keyframes fadeTrail { 0% { transform: scale(1); opacity: 0.8; } 100% { transform: scale(0); opacity: 0; margin-top: 10px; } }

        /* --- PAGE TRANSITIONS --- */
        .page-section {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            opacity: 0; pointer-events: none; visibility: hidden;
            transition: opacity 0.6s ease-in-out, visibility 0.6s;
            z-index: 10;
        }
        .page-section.active {
            opacity: 1; pointer-events: auto; visibility: visible; z-index: 20;
        }

        /* DEFAULT (Mobile) */
        .paper-slide-out { animation: slideOutMobile 0.6s ease-in-out forwards; }
        .paper-slide-in { animation: slideInMobile 0.6s ease-in-out forwards; }
        .paper-slide-out-rev { animation: slideOutRevMobile 0.6s ease-in-out forwards; }
        .paper-slide-in-rev { animation: slideInRevMobile 0.6s ease-in-out forwards; }

        @keyframes slideOutMobile { 0% { transform: translateX(0); opacity: 1; } 100% { transform: translateX(-100%); opacity: 0; } }
        @keyframes slideInMobile { 0% { transform: translateX(100%); opacity: 0; } 100% { transform: translateX(0); opacity: 1; } }
        @keyframes slideOutRevMobile { 0% { transform: translateX(0); opacity: 1; } 100% { transform: translateX(100%); opacity: 0; } }
        @keyframes slideInRevMobile { 0% { transform: translateX(-100%); opacity: 0; } 100% { transform: translateX(0); opacity: 1; } }

        /* DESKTOP */
        @media (min-width: 768px) {
            .paper-slide-out { animation: slideOutDesktop 0.6s ease-in-out forwards; }
            .paper-slide-in { animation: slideInDesktop 0.6s ease-in-out forwards; }
            .paper-slide-out-rev { animation: slideOutRevDesktop 0.6s ease-in-out forwards; }
            .paper-slide-in-rev { animation: slideInRevDesktop 0.6s ease-in-out forwards; }

            @keyframes slideOutDesktop { 0% { transform: translateX(0); opacity: 1; } 100% { transform: translateX(-50px); opacity: 0; } }
            @keyframes slideInDesktop { 0% { transform: translateX(50px); opacity: 0; } 100% { transform: translateX(0); opacity: 1; } }
            @keyframes slideOutRevDesktop { 0% { transform: translateX(0); opacity: 1; } 100% { transform: translateX(50px); opacity: 0; } }
            @keyframes slideInRevDesktop { 0% { transform: translateX(-50px); opacity: 0; } 100% { transform: translateX(0); opacity: 1; } }
        }

        /* --- UI ELEMENTS --- */
        .grain-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 9000; opacity: 0.05; background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E"); }
        
        #page1 { 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: center; 
        }
        
        #background-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; pointer-events: none; overflow: hidden; }
        .bg-item { position: absolute; top: 110%; opacity: 0; animation: riseUp linear infinite; }
        @keyframes riseUp { 0% { top: 110%; transform: rotate(0deg); opacity: 0; } 10% { opacity: 0.8; } 90% { opacity: 0.8; } 100% { top: -20%; transform: rotate(360deg); opacity: 0; } }

        .invite-text { position: relative; z-index: 30; font-family: 'Patrick Hand', cursive; color: #5c4d42; font-size: 1.8rem; text-align: center; margin-bottom: 70px; line-height: 1.4; max-width: 85%; pointer-events: none; text-shadow: 2px 2px 0px rgba(255,255,255,0.6); }
        
        .sticker-wrapper { 
            position: relative; 
            width: 240px; height: 70px; 
            z-index: 40; 
            transform: rotate(-4deg); 
            box-shadow: 0px 10px 10px rgba(92, 77, 66, 0.1); 
            border-radius: 50px; 
            background: rgba(0,0,0,0.05); 
            margin: 0; 
        }
        
        .sticker { position: absolute; top: 0; left: 0; width: 100%; height: 100%; transform-style: preserve-3d; transform-origin: left center; transition: transform 0.1s; border-radius: 50px; }
        .face { position: absolute; top: 0; left: 0; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 50px; display: flex; align-items: center; justify-content: center; font-family: 'Patrick Hand', cursive; font-size: 1.8rem; box-shadow: 2px 2px 5px rgba(0,0,0,0.1); border: 2px solid #5c4d42; }
        .face-front { background: var(--sticker-front); color: #5c4d42; z-index: 2; }
        .face-back { background: var(--sticker-back); color: #d4a373; transform: rotateY(180deg); box-shadow: inset 0 0 10px rgba(0,0,0,0.1); }
        .doodle-arrow { position: absolute; left: -50px; top: 20px; font-size: 2rem; color: #5c4d42; transform: rotate(-15deg); animation: bounceX 1s infinite alternate; font-family: 'Patrick Hand', cursive; pointer-events: none; }
        
        /* --- START BUTTON STAR ANIMATION --- */
        .start-star { 
            position: absolute; right: -40px; top: -40px; 
            width: 50px; height: 50px; /* Big Size */
            pointer-events: none; 
            animation: fadeStar 2.5s ease-in-out infinite; 
        }
        @keyframes fadeStar { 
            0%, 100% { opacity: 0.5; transform: scale(0.9) rotate(0deg); } 
            50% { opacity: 1; transform: scale(1.1) rotate(10deg); } 
        }

        @keyframes bounceX { from { transform: translateX(0) rotate(-15deg); } to { transform: translateX(-10px) rotate(-15deg); } }

        /* UI ELEMENTS */
        .page-title { position: fixed; top: 15%; left: 50%; transform: translate(-50%, -50%); font-family: 'Patrick Hand', cursive; font-size: 2rem; color: #5c4d42; width: 100%; text-align: center; z-index: 50; pointer-events: none; }
        
        .credits-container { position: fixed; top: 25px; right: 25px; z-index: 2000; display: flex; flex-direction: column; align-items: flex-end; }
        .credits-btn { background: rgba(255,255,255,0.8); border: 1px solid rgba(255,255,255,0.6); padding: 8px 18px; border-radius: 30px; color: var(--text); font-size: 0.75rem; font-weight: 600; text-transform: uppercase; backdrop-filter: blur(8px); }
        .credits-dropdown { margin-top: 15px; background: rgba(255,255,255,0.95); border-radius: 20px; padding: 20px; min-width: 140px; opacity: 0; transform: translateY(-10px); pointer-events: none; transition: 0.3s; position: absolute; top: 40px; right: 0; box-shadow: 0 10px 30px rgba(0,0,0,0.05); }
        .credits-dropdown.show { opacity: 1; transform: translateY(0); pointer-events: auto; }
        .credit-item { margin-bottom: 8px; font-size: 0.7rem; color: #999; border-bottom: 1px solid #eee; padding-bottom: 4px; }
        .credit-name { display: block; color: var(--text); font-weight: 600; font-size: 0.85rem; }
        
        /* MENU */
        .menu-container { position: fixed; bottom: 30px; right: 30px; z-index: 1000; display: flex; flex-direction: column-reverse; align-items: center; gap: 15px; }
        .main-menu-btn { width: 65px; height: 65px; background: #4a3b32; color: #fffcf2; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; box-shadow: 0 8px 20px rgba(74, 59, 50, 0.3); transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); z-index: 1002; pointer-events: auto; }
        .tool-list { display: flex; flex-direction: column-reverse; gap: 12px; align-items: center; margin-bottom: 5px; pointer-events: none; }
        .tool-btn { width: 50px; height: 50px; background: rgba(255,255,255,0.9); border: 1px solid white; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 10px rgba(0,0,0,0.05); backdrop-filter: blur(5px); opacity: 0; transform: translateY(20px) scale(0.8); transition: all 0.3s cubic-bezier(0.4, 0.0, 0.2, 1); pointer-events: auto; }
        .tool-btn svg { width: 22px; height: 22px; stroke: #5c4d42; stroke-width: 1.5; fill: none; stroke-linecap: round; stroke-linejoin: round; }
        .tool-btn.active-tool { background: #ff6b6b; border-color: #ff6b6b; transform: scale(1.1) !important; }
        .tool-btn.active-tool svg { stroke: white; }
        .menu-open .tool-btn { opacity: 1; transform: translateY(0) scale(1); }
        .menu-open .main-menu-btn { transform: rotate(45deg); background: #d64933; }
        .menu-open .tool-btn:nth-child(1) { transition-delay: 0.05s; } .menu-open .tool-btn:nth-child(2) { transition-delay: 0.1s; } .menu-open .tool-btn:nth-child(3) { transition-delay: 0.15s; } .menu-open .tool-btn:nth-child(4) { transition-delay: 0.2s; }
        
        /* NAVIGATION TEXT BUTTONS */
        .nav-group { position: fixed; bottom: 30px; left: 30px; z-index: 1000; display: flex; gap: 15px; align-items: center; pointer-events: auto; }
        .nav-btn { 
            background: white; border: 2px solid var(--text); padding: 10px 20px; 
            border-radius: 20px; font-family: 'Patrick Hand', cursive; font-size: 1.2rem;
            cursor: pointer; transition: transform 0.2s; box-shadow: 3px 3px 0px rgba(92, 77, 66, 0.1);
        }
        .nav-btn:hover { transform: scale(1.05); }
        .nav-btn:active { transform: scale(0.95); }

        /* INTERMEDIATE PAGE */
        .intermediate-text { position: relative; z-index: 10; font-family: 'Patrick Hand', cursive; font-size: 1.8rem; color: var(--text); text-align: center; margin-bottom: 50px; padding: 0 20px; max-width: 85%; line-height: 1.5; }
        
        #page4 { display: flex; flex-direction: column; align-items: center; justify-content: center; }
        
        /* RAIN ELEMENTS */
        .falling-item { position: absolute; top: -100px; pointer-events: none; }
        .falling-vector { font-family: 'Patrick Hand', cursive; color: rgba(92, 77, 66, 0.3); font-size: 1.5rem; z-index: 1; animation: fallDownVector linear infinite; }
        .falling-envelope { z-index: 1; font-size: 2rem; opacity: 0.3; animation: fallDownEnvelope linear infinite; }
        .falling-envelope-celebration { z-index: 1; font-size: 1.8rem; opacity: 0.4; animation: fallDownCelebration linear infinite; }
        .falling-text {
            position: absolute; top: -50px; font-family: 'Patrick Hand', cursive; 
            color: #d8b4e2; font-size: 0.9rem; opacity: 0.5; pointer-events: none; z-index: 55; 
            white-space: nowrap; animation: fallDownText linear infinite;
        }
        
        /* --- GLOWING WHITE DOTS (BACKGROUND) --- */
        .particle { 
            position: absolute; pointer-events: none; z-index: 52; opacity: 0; 
            animation: floatUpParticle linear infinite; 
            background: white; border-radius: 50%;
            box-shadow: 0 0 5px white, 0 0 10px rgba(255,255,255,0.5);
        }
        
        /* --- CONFETTI (EMOJIS) --- */
        .confetti { position: absolute; pointer-events: none; z-index: 9000; font-size: 1.5rem; }

        @keyframes fallDownVector { 0% { top: -10%; transform: rotate(0deg); } 100% { top: 110%; transform: rotate(180deg); } }
        @keyframes fallDownEnvelope { 0% { top: -10%; transform: rotate(0deg); } 100% { top: 110%; transform: rotate(20deg); } }
        @keyframes fallDownCelebration { 0% { top: -10%; transform: rotate(0deg); opacity: 0; } 20% { opacity: 0.4; } 100% { top: 110%; transform: rotate(-10deg); opacity: 0; } }
        @keyframes fallDownText { 0% { top: -10%; opacity: 0; } 15% { opacity: 0.5; } 85% { opacity: 0.5; } 100% { top: 110%; opacity: 0; } }
        @keyframes floatUpParticle { 0% { transform: translateY(100vh) rotate(0deg); opacity: 0; } 20% { opacity: 0.8; } 80% { opacity: 0.8; } 100% { transform: translateY(-10vh) scale(1); opacity: 0; } }

        .final-glow { font-family: 'Patrick Hand', cursive; font-size: 3rem; color: #fff; text-align: center; line-height: 1.4; text-shadow: 0 0 15px rgba(255, 255, 255, 0.2), 0 0 30px rgba(188, 19, 254, 0.4); animation: softPulse 5s ease-in-out infinite; position: relative; z-index: 60; padding: 0 20px; }
        
        /* --- MUSIC ICON IN TEXT (Big & Spinning) --- */
        .music-icon {
            display: inline-block;
            width: 55px; height: 55px; /* Bigger */
            vertical-align: middle;
            margin-left: 10px; margin-bottom: 5px;
            animation: spinMusic 4s linear infinite;
        }
        @keyframes spinMusic { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

        @keyframes softPulse { 0%, 100% { transform: scale(1); opacity: 0.95; } 50% { transform: scale(1.02); opacity: 1; } }
        .question-text { position: relative; z-index: 50; font-family: 'Patrick Hand', cursive; font-size: 2.5rem; color: var(--text); text-align: center; margin-bottom: 50px; max-width: 80%; line-height: 1.2; animation: breathe 3s ease-in-out infinite; }
        @keyframes breathe { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }
        .option-group { position: relative; z-index: 50; display: flex; flex-wrap: wrap; justify-content: center; max-width: 320px; gap: 15px; }
        .option-sticker { padding: 12px 25px; border: 2px solid var(--text); background: white; font-family: 'Patrick Hand', cursive; font-size: 1.3rem; border-radius: 255px 15px 225px 15px / 15px 225px 15px 255px; transition: transform 0.2s; box-shadow: 3px 3px 0px rgba(0,0,0,0.1); user-select: none; }
        .option-sticker:active { transform: scale(0.9) !important; }
        #btn-nah { position: relative; transition: top 0.2s, left 0.2s; } 
        #final-msg { margin-top: 40px; font-family: 'Patrick Hand', cursive; font-size: 1.6rem; color: #d4a373; text-align: center; min-height: 50px; padding: 0 20px; position:relative; z-index:50; }
        
        /* FLOWERS */
        .flower { 
            position: absolute; pointer-events: none; 
            transform: translate(-50%, -50%) scale(0); 
            animation: bloom 0.8s cubic-bezier(0.34, 1.56, 0.64, 1) forwards; 
            filter: drop-shadow(4px 4px 6px rgba(0,0,0,0.1)); 
            z-index: 2000; 
        }
        @keyframes bloom { to { transform: translate(-50%, -50%) scale(1) rotate(var(--r)); } }
        .bubble { position: absolute; background: #fff; padding: 10px 20px; border-radius: 2px 20px 20px 20px; font-family: 'Patrick Hand', cursive; font-size: 1.2rem; color: var(--text); pointer-events: none; animation: floatUpBubble 4s ease-out forwards; z-index: 100; white-space: nowrap; box-shadow: 2px 4px 15px rgba(0,0,0,0.05); transform: rotate(-2deg); }
        @keyframes floatUpBubble { 0% { opacity: 0; transform: translate(-50%, 10px) rotate(-2deg); } 15% { opacity: 1; transform: translate(-50%, 0) rotate(-2deg); } 100% { opacity: 0; transform: translate(-50%, -120px) rotate(5deg); } }

        /* MODALS */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.3); z-index: 9000; display: none; align-items: center; justify-content: center; backdrop-filter: blur(3px); opacity: 0; transition: opacity 0.3s; }
        .modal-overlay.open { opacity: 1; }
        .paper-note { background: #fffcf2; width: 80%; max-width: 300px; padding: 30px; border-radius: 2px; box-shadow: 0 10px 30px rgba(0,0,0,0.15); font-family: 'Patrick Hand', cursive; font-size: 1.3rem; color: #4a3b32; line-height: 1.6; transform: rotate(-2deg); position: relative; }
        .close-note { position: absolute; top: 10px; right: 15px; font-size: 1.5rem; color: #aaa; cursor: pointer; }
        .secret-box { background: #fff; padding: 25px; border-radius: 20px; text-align: center; font-family: 'Inter', sans-serif; box-shadow: 0 10px 30px rgba(0,0,0,0.2); width: 250px; }
        .secret-input { width: 80%; padding: 10px; margin: 15px 0; border: 2px solid #eee; border-radius: 10px; font-family: 'Inter', sans-serif; outline: none; }
        .secret-btn { background: #d4a373; color: white; border: none; padding: 8px 20px; border-radius: 15px; font-weight: 600; cursor: pointer; }
        #hint { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); pointer-events: none; color: #d4a373; letter-spacing: 4px; font-size: 0.8rem; z-index: 10; display: none; }
        #music-status { position: fixed; top: 30px; left: 25px; font-size: 0.7rem; color: #d4a373; letter-spacing: 2px; font-weight: 600; text-transform: uppercase; display: none; }
    </style>
</head>
<body>
    <div id="doodle-cursor"></div>
    <div class="grain-overlay"></div>

    <div id="page1" class="page-section active">
        <div id="background-layer"></div>
        <h1 class="invite-text">This is an invitation to my<br>possibly future friend : )</h1>
        <div class="sticker-wrapper">
            <div class="doodle-arrow">‚ûú</div>
            
            <img src="star.png" class="start-star">
            
            <div class="sticker" id="sticker-btn">
                <div class="face face-front">Start Here</div>
                <div class="face face-back">Opening...</div>
            </div>
        </div>
        <div style="margin-top: 20px; color:#aaa; font-size:0.7rem; font-family:'Inter'; text-transform:uppercase; letter-spacing:1px; opacity:0.6;">&lt;&lt; PEEL TO OPEN</div>
    </div>

    <div id="page2" class="page-section" onclick="handleOutsideClick(event)">
        <div class="nav-group">
            <button class="nav-btn" onclick="navigateTo('page1')">Back</button>
            <button class="nav-btn" onclick="navigateTo('page3')">Next ‚ûú</button>
        </div>

        <h2 class="page-title">What i know about u</h2>

        <div class="credits-container">
            <button class="credits-btn" onclick="toggleCredits(event)">Credits</button>
            <div class="credits-dropdown" id="creditsMenu">
                <div class="credit-item"><span class="credit-name">Faizan</span>Director</div>
                <div class="credit-item"><span class="credit-name">Gemini Pro</span>Writer</div>
                <div class="credit-item"><span class="credit-name">Time</span>lgta hai bhai</div>
            </div>
        </div>

        <div class="menu-container" id="menuContainer" onmouseenter="openMenu()" onmouseleave="closeMenu()">
            <div class="main-menu-btn" onclick="toggleMenuMobile(event)">+</div>
            <div class="tool-list">
                <div class="tool-btn" id="broom-btn" onclick="toggleEraser(event)">
                    <svg viewBox="0 0 24 24"><path d="M12 2L2 12l4 4 10-10-4-4zM2 12l10 10 4-4-10-10-4 4z"></path><path d="M16 16l4 4"></path></svg>
                </div>
                <div class="tool-btn" onclick="openLetter()">
                    <svg viewBox="0 0 24 24"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
                </div>
                <div class="tool-btn" onclick="openSecretLock()">
                    <svg viewBox="0 0 24 24"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>
                </div>
                <div class="tool-btn" onclick="takeScreenshotMode()">
                    <svg viewBox="0 0 24 24"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path><circle cx="12" cy="13" r="4"></circle></svg>
                </div>
            </div>
        </div>
    </div>

    <div id="page3" class="page-section" style="display:flex; flex-direction:column; align-items:center; justify-content:center;">
        <div class="nav-group">
            <button class="nav-btn" onclick="navigateTo('page2')">Back</button>
            <button class="nav-btn" onclick="navigateTo('page4')">Ask ‚ûú</button>
        </div>

        <p class="intermediate-text">So that's all i know about u & i bet theres more , but before that i got a question to ask u....</p>
    </div>

    <div id="page4" class="page-section">
        <div class="nav-group" id="q-nav">
            <button class="nav-btn" onclick="navigateTo('page3')">Back</button>
        </div>
        
        <div id="q-content">
            <h1 class="question-text">Can we be friends?</h1>
            <div class="option-group">
                <div class="option-sticker" style="transform: rotate(-2deg);" onclick="answer('yes')">Yess!</div>
                <div class="option-sticker" style="transform: rotate(3deg);" onclick="answer('think')">I will think</div>
                <div class="option-sticker" style="transform: rotate(-1deg);" onclick="answer('donno')">Umm donno</div>
                <div class="option-sticker" id="btn-nah" style="transform: rotate(2deg);" onmouseover="moveNah()" onclick="moveNah()">Nah...</div>
            </div>
        </div>

        <div id="final-msg"></div>
    </div>

    <div id="letter-modal" class="modal-overlay" onclick="closeModal('letter-modal')">
        <div class="paper-note" onclick="event.stopPropagation()">
            <span class="close-note" onclick="closeModal('letter-modal')">&times;</span>
            <p>Hey,<br><br>Just wanted to make something as cool as you.<br>Hope this brings a smile to your face!<br><br>- Faizan</p>
        </div>
    </div>

    <div id="secret-lock-modal" class="modal-overlay" onclick="closeModal('secret-lock-modal')">
        <div class="secret-box" onclick="event.stopPropagation()">
            <span class="close-note" onclick="closeModal('secret-lock-modal')">&times;</span>
            <h3>Top Secret ü§´</h3>
            <p style="font-size: 0.8rem; color: #888;">Enter Password:</p>
            <input type="text" id="secret-pass" class="secret-input" placeholder="???">
            <button class="secret-btn" onclick="checkPassword()">Unlock</button>
        </div>
    </div>

    <div id="secret-content-modal" class="modal-overlay" onclick="closeModal('secret-content-modal')">
        <div class="paper-note" style="background: #e3f2fd; transform: rotate(1deg);" onclick="event.stopPropagation()">
            <span class="close-note" onclick="closeModal('secret-content-modal')">&times;</span>
            <h3 style="text-align:center;">üéâ Access Granted!</h3>
            <p>(This space is waiting for your secret content...)</p>
        </div>
    </div>

    <div id="hint">TAP & DRAG</div>
    <div id="music-status"></div>
    <audio id="bg-audio"></audio>

    <script>
        const cursor = document.getElementById('doodle-cursor');
        document.addEventListener('mousemove', (e) => {
            cursor.style.left = e.clientX + 'px'; cursor.style.top = e.clientY + 'px';
            spawnTrail(e.clientX, e.clientY);
            const hovered = document.elementFromPoint(e.clientX, e.clientY);
            if (hovered && (hovered.tagName === 'BUTTON' || hovered.classList.contains('sticker') || hovered.closest('.tool-btn') || hovered.classList.contains('option-sticker') || hovered.classList.contains('main-menu-btn') || hovered.closest('.nav-btn'))) {
                cursor.classList.add('hovering');
            } else { cursor.classList.remove('hovering'); }
        });
        document.addEventListener('mousedown', () => cursor.classList.add('clicking'));
        document.addEventListener('mouseup', () => cursor.classList.remove('clicking'));
        
        document.addEventListener('touchmove', (e) => {
            const t = e.touches[0];
            spawnTrail(t.clientX, t.clientY);
        });

        function spawnTrail(x, y) {
            const p2 = document.getElementById('page2');
            const p3 = document.getElementById('page3');
            if (!p2.classList.contains('active') && !p3.classList.contains('active')) return;

            const trail = document.createElement('div');
            trail.className = 'cursor-trail';
            trail.style.left = x + 'px'; trail.style.top = y + 'px';
            document.body.appendChild(trail);
            setTimeout(() => trail.remove(), 800);
        }

        const playlist = ['song1.mp3', 'song2.mp3']; 
        let currentTrack = 0;
        const colors = ['#f8ad9d', '#fbc4ab', '#ffdab9', '#ece4db', '#d8e2dc'];
        const notes = [ "Independent person ‚úã", "Never sleeps.. ü¶â", "Possibly Batwoman? ü§î", "top-tier friend üèÜ", "elite music taste üòå", "10/10 human üåü", "insane vibes ‚ú®", "Nonchalant fr üò¨", "Caring ü´Ç", "Needs to be studied üßê", "secretly a genius üòé", "Nevers backsoff üëÄ", "linguistic person üìö" ];
        const rainTexts = [ "the design wasn't nonchalant enough", "I think I'm online ü§î", "do u like it?", "Aaaa.....", "shaba bakhair", "what time is it rn?", "ahh i forgot turn the lights on", "hows the song", "today is 30 july", "no questions?" ];
        const aestheticVectors = ["|", "*", "¬∑", "~", "¬∞", "+"];

        const audio = document.getElementById('bg-audio');
        const sticker = document.getElementById('sticker-btn');
        let isStarted = false;
        let isEraserActive = false;

        document.body.addEventListener('click', () => {
            if (audio.paused && !document.getElementById('page4').classList.contains('active')) {
                audio.src = playlist[0];
                audio.play().catch(e => console.log("Waiting for interaction...", e));
            }
        }, { once: true });

        function initBackground() {
            const container = document.getElementById('background-layer');
            for(let i=0; i<50; i++) {
                const el = document.createElement('div'); el.className = 'bg-item';
                const size = Math.random() * 40 + 30; 
                if(Math.random() > 0.5) {
                    const color = colors[Math.floor(Math.random() * colors.length)];
                    el.innerHTML = `<svg width="${size}" height="${size}" viewBox="0 0 100 100"><circle cx="50" cy="30" r="25" fill="${color}" stroke="#5c4d42" stroke-width="1.5" stroke-opacity="0.3" /><circle cx="50" cy="70" r="25" fill="${color}" stroke="#5c4d42" stroke-width="1.5" stroke-opacity="0.3" /><circle cx="30" cy="50" r="25" fill="${color}" stroke="#5c4d42" stroke-width="1.5" stroke-opacity="0.3" /><circle cx="70" cy="50" r="25" fill="${color}" stroke="#5c4d42" stroke-width="1.5" stroke-opacity="0.3" /><circle cx="50" cy="50" r="12" fill="#fffcf2"/></svg>`;
                } else {
                    el.innerHTML = `<svg width="${size}" height="${size}" viewBox="0 0 100 100" fill="none" stroke="#d4a373" stroke-width="2.5" stroke-linecap="round"><path d="M10,50 Q30,10 50,50 T90,50" transform="rotate(${Math.random()*360} 50 50)"/></svg>`;
                }
                el.style.left = Math.random() * 100 + 'vw';
                el.style.animationDuration = (Math.random() * 15 + 15) + 's';
                el.style.animationDelay = (Math.random() * -30) + 's'; 
                container.appendChild(el);
            }
        }

        // --- PAGE NAVIGATION ---
        function navigateTo(pageId) {
            document.querySelectorAll('.page-section').forEach(p => p.classList.remove('active'));
            const target = document.getElementById(pageId);
            target.classList.add('active');

            // === CRITICAL FIX: CLEAN FLOWERS WHEN LEAVING PAGE 2 ===
            if (pageId !== 'page2') {
                const flowers = document.querySelectorAll('.flower');
                flowers.forEach(f => f.remove());
            }

            if (pageId === 'page1') {
                isStarted = false;
                sticker.style.opacity = '1'; sticker.style.transform = 'rotateY(0deg)';
                document.getElementById('hint').style.display = 'none';
            }
            if (pageId === 'page2') {
                document.getElementById('hint').style.display = 'block';
                document.getElementById('music-status').style.display = 'block';
                document.getElementById('music-status').innerText = "Vibing... üéµ";
                // Clear any falling items if coming back
                document.querySelectorAll('.falling-item').forEach(i => i.remove());
            }
            if (pageId === 'page3') {
                document.getElementById('hint').style.display = 'none';
                initVectorRain();
            }
            if (pageId === 'page4') {
                initFinalRain();
            }
        }

        let isDragging = false, startX = 0;
        function startDrag(e) { 
            if(isStarted) return; isDragging = true; startX = e.type.includes('touch') ? e.touches[0].clientX : e.clientX; sticker.style.transition = 'none';
            if (audio.paused) { audio.src = playlist[0]; audio.play(); }
        }
        function drag(e) {
            if(!isDragging || isStarted) return;
            const clientX = e.type.includes('touch') ? e.touches[0].clientX : e.clientX;
            const deltaX = clientX - startX;
            if(deltaX > 0) return;
            let rotation = Math.max(deltaX / 1.2, -170);
            sticker.style.transform = `rotateY(${rotation}deg)`;
            if(rotation < -130) { isDragging = false; startExperience(); }
        }
        function endDrag() { if(!isDragging) return; isDragging = false; sticker.style.transition = 'transform 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275)'; sticker.style.transform = `rotateY(0deg)`; }

        sticker.addEventListener('mousedown', startDrag); window.addEventListener('mousemove', drag); window.addEventListener('mouseup', endDrag);
        sticker.addEventListener('touchstart', startDrag); window.addEventListener('touchmove', drag); window.addEventListener('touchend', endDrag);

        function startExperience() {
            if(isStarted) return; isStarted = true; 
            sticker.style.transition = 'all 0.8s ease-in'; 
            sticker.style.transform = 'rotateY(-180deg) translateX(-100px) scale(1.1)'; 
            sticker.style.opacity = '0';
            if (audio.paused) { audio.src = playlist[0]; audio.play(); }
            setTimeout(() => navigateTo('page2'), 800);
        }

        // --- RAIN FUNCTIONS ---
        function initVectorRain() {
            const container = document.getElementById('page3');
            const old = container.querySelectorAll('.falling-item'); old.forEach(o=>o.remove());
            
            for(let i=0; i<40; i++) { 
                const vec = document.createElement('div');
                vec.className = 'falling-item falling-vector';
                vec.innerText = aestheticVectors[Math.floor(Math.random() * aestheticVectors.length)];
                vec.style.left = Math.random() * 100 + 'vw'; 
                vec.style.animationDuration = (Math.random() * 8 + 5) + 's';
                vec.style.animationDelay = (Math.random() * 5) + 's';
                container.appendChild(vec);
            }
        }

        function initFinalRain() {
            const container = document.getElementById('page4');
            const old = container.querySelectorAll('.falling-item'); old.forEach(o=>o.remove());

            for(let i=0; i<25; i++) {
                const env = document.createElement('div'); env.className = 'falling-item falling-envelope';
                env.innerText = '‚úâÔ∏è';
                env.style.left = Math.random() * 100 + 'vw';
                env.style.animationDuration = (Math.random()*5 + 8) + 's';
                env.style.animationDelay = (Math.random()*5) + 's';
                container.appendChild(env);
            }
        }

        function createParticles() {
            const container = document.getElementById('page4');
            for(let i=0; i<40; i++) {
                const p = document.createElement('div');
                p.className = 'particle';
                const size = Math.random() * 3 + 2;
                p.style.width = size + 'px'; p.style.height = size + 'px';
                p.style.left = Math.random() * 100 + 'vw';
                p.style.animationDuration = (Math.random() * 10 + 10) + 's';
                p.style.animationDelay = (Math.random() * 5) + 's';
                container.appendChild(p);
            }
        }

        function startCelebrationRain() {
            const container = document.getElementById('page4');
            const existing = container.querySelectorAll('.falling-envelope');
            existing.forEach(el => el.style.opacity = '0'); 

            for(let i=0; i<15; i++) {
                const env = document.createElement('div'); env.className = 'falling-item falling-envelope-celebration';
                env.innerText = '‚úâÔ∏è';
                env.style.left = Math.random() * 100 + 'vw';
                env.style.animationDuration = (Math.random()*10 + 10) + 's'; 
                if(Math.random() > 0.5) env.style.filter = "blur(2px)"; 
                container.appendChild(env);
            }

            for(let i=0; i<rainTexts.length; i++) {
                const txt = document.createElement('div'); txt.className = 'falling-text';
                txt.innerText = rainTexts[i];
                const r = Math.random(); 
                let leftPos = r < 0.5 ? Math.random() * 15 : 85 + (Math.random() * 15);
                txt.style.left = leftPos + 'vw';
                txt.style.animationDuration = (Math.random() * 10 + 15) + 's'; 
                txt.style.animationDelay = (Math.random() * 5) + 's';
                container.appendChild(txt);
            }
            createParticles();
        }

        function moveNah() {
            const btn = document.getElementById('btn-nah');
            const x = Math.random() * (window.innerWidth - 120);
            const y = Math.random() * (window.innerHeight - 100);
            btn.style.position = 'fixed'; btn.style.left = x + 'px'; btn.style.top = y + 'px';
        }

        function answer(type) {
            const msg = document.getElementById('final-msg');
            const container = document.getElementById('page4');
            const content = document.getElementById('q-content');
            
            document.getElementById('q-nav').style.display = 'none'; 

            if(type === 'yes') {
                container.style.background = "#000";
                container.style.backgroundImage = "none";
                content.style.display = 'none';
                
                // === REPLACED TEXT SPARKLE WITH MUSIC ICON ===
                msg.innerHTML = '<h1 class="final-glow">We‚Äôre officially friends now <img src="music.png" class="music-icon"></h1>';
                
                // === FADE IN AUDIO ===
                audio.pause();
                const celebration = new Audio('Song3.mp3');
                
                // FADE LOGIC: Start 20%, +30% every 2s
                let vol = 0.2;
                celebration.volume = vol;
                
                celebration.play().catch(e => console.log("Audio play error", e));
                
                const fadeInterval = setInterval(() => {
                    if (vol < 1.0) {
                        vol = Math.min(vol + 0.3, 1.0); // +0.3, max 1.0
                        celebration.volume = vol;
                    } else {
                        clearInterval(fadeInterval);
                    }
                }, 2000); // 2000ms = 2 seconds

                celebration.onended = function() {
                    const nextSong = new Audio('song4.mp3');
                    nextSong.play().catch(e => console.log("Song 4 error", e));
                };
                
                startCelebrationRain();
                explodeConfetti();
            } else if(type === 'think') {
                msg.innerText = "Take your time, I'm not going anywhere üòå";
                msg.style.color = "#d4a373";
            } else {
                msg.innerText = "I'll take that as a 'maybe soon' üòâ";
                msg.style.color = "#d4a373";
            }
        }

        function explodeConfetti() {
            // === EMOJIS FOR CONFETTI ===
            const particles = ['üå∏', '‚úâÔ∏è', '‚ù§Ô∏è', '‚ú®', 'üíå', 'üëç'];
            for(let i=0; i<300; i++) {
                const c = document.createElement('div'); c.className = 'confetti';
                c.innerText = particles[Math.floor(Math.random() * particles.length)];
                c.style.left = '50%'; c.style.top = '50%';
                c.style.fontSize = Math.random()*20 + 10 + 'px';
                document.body.appendChild(c);
                const destX = (Math.random() - 0.5) * window.innerWidth * 1.5;
                const destY = (Math.random() - 0.5) * window.innerHeight * 1.5;
                const rotation = Math.random() * 720;
                const anim = c.animate([ { transform: 'translate(0,0) rotate(0deg)', opacity: 1 }, { transform: `translate(${destX}px, ${destY}px) rotate(${rotation}deg)`, opacity: 0 } ], { duration: 1500 + Math.random()*2000, easing: 'cubic-bezier(0.25, 1, 0.5, 1)' });
                anim.onfinish = () => c.remove();
            }
        }

        function openMenu() { document.getElementById('menuContainer').classList.add('menu-open'); }
        function closeMenu() { document.getElementById('menuContainer').classList.remove('menu-open'); }
        function toggleMenuMobile(e) { e.stopPropagation(); document.getElementById('menuContainer').classList.toggle('menu-open'); }
        function handleOutsideClick(e) { if (!e.target.closest('.menu-container')) { document.getElementById('menuContainer').classList.remove('menu-open'); } }

        function toggleEraser(e) {
            if(e) e.stopPropagation();
            isEraserActive = !isEraserActive;
            const btn = document.getElementById('broom-btn');
            if(isEraserActive) {
                btn.classList.add('active-tool'); document.getElementById('hint').innerText = "TAP FLOWER TO ERASE"; document.getElementById('hint').style.display = 'block';
            } else {
                btn.classList.remove('active-tool'); document.getElementById('hint').innerText = "TAP & DRAG"; document.getElementById('hint').style.display = 'none';
            }
        }

        function openLetter() { const m=document.getElementById('letter-modal'); m.style.display='flex'; setTimeout(()=>m.classList.add('open'),10); }
        function openSecretLock() { const m=document.getElementById('secret-lock-modal'); m.style.display='flex'; setTimeout(()=>m.classList.add('open'),10); }
        function closeModal(id) { const m=document.getElementById(id); m.classList.remove('open'); setTimeout(()=>m.style.display='none',300); }
        function checkPassword() { if(document.getElementById('secret-pass').value==="Im nonchalant"){ alert("Case Unlocked! (Instructions pending...)"); } else { alert("Wrong Password üò¨"); } }
        function takeScreenshotMode() { document.getElementById('page2-ui').style.opacity='0'; setTimeout(()=>document.getElementById('page2-ui').style.opacity='1',4000); }
        function toggleCredits(e) { e.stopPropagation(); document.getElementById('creditsMenu').classList.toggle('show'); }
        window.addEventListener('click', (e) => { if (!e.target.closest('.credits-container')) document.getElementById('creditsMenu').classList.remove('show'); });

        function handleInteraction(x, y) {
            const title = document.getElementById('page2-title'); if(title && title.style.opacity > 0.1) title.style.opacity = '0';
            
            // Allow flowers ONLY if Page 2 is active
            if (!document.getElementById('page2').classList.contains('active')) return;

            if(isEraserActive) {
                const flowers = document.querySelectorAll('.flower');
                flowers.forEach(flower => {
                    const rect = flower.getBoundingClientRect();
                    if(Math.hypot(x - (rect.left + rect.width / 2), y - (rect.top + rect.height / 2)) < 50) flower.remove();
                });
                return;
            }
            createFlower(x, y);
        }

        function createFlower(x, y) {
            const color = colors[Math.floor(Math.random() * colors.length)];
            const size = Math.random() * 40 + 50; 
            const flower = document.createElement('div'); flower.className = 'flower';
            flower.style.left = x + 'px'; flower.style.top = y + 'px'; 
            flower.style.setProperty('--r', Math.random()*360+'deg');
            flower.innerHTML = `<svg width="${size}" height="${size}" viewBox="0 0 100 100"><circle cx="50" cy="30" r="25" fill="${color}" stroke="rgba(0,0,0,0.05)"/><circle cx="50" cy="70" r="25" fill="${color}" stroke="rgba(0,0,0,0.05)"/><circle cx="30" cy="50" r="25" fill="${color}" stroke="rgba(0,0,0,0.05)"/><circle cx="70" cy="50" r="25" fill="${color}" stroke="rgba(0,0,0,0.05)"/><circle cx="50" cy="50" r="12" fill="#fffcf2"/><path d="M50 30 L50 70 M30 50 L70 50" stroke="rgba(0,0,0,0.1)" stroke-width="1.2"/></svg>`;
            document.body.appendChild(flower);
            if(Math.random() < 0.3) {
                const b = document.createElement('div'); b.className = 'bubble';
                b.style.left = x + 'px'; b.style.top = (y-60) + 'px';
                b.innerText = notes[Math.floor(Math.random()*notes.length)];
                document.body.appendChild(b); setTimeout(() => b.remove(), 4000);
            }
            if(document.querySelectorAll('.flower').length > 30) document.querySelector('.flower').remove();
        }

        let lastX=0, lastY=0;
        window.addEventListener('touchmove', (e) => { if(!isStarted) return; const t = e.touches[0]; if(Math.hypot(t.clientX-lastX, t.clientY-lastY)>20) { handleInteraction(t.clientX, t.clientY); lastX=t.clientX; lastY=t.clientY; } }, {passive: false});
        window.addEventListener('mousemove', (e) => { if(!isStarted || e.buttons === 0) return; if(Math.hypot(e.clientX-lastX, e.clientY-lastY)>20) { handleInteraction(e.clientX, e.clientY); lastX=e.clientX; lastY=e.clientY; } });
        window.addEventListener('touchstart', (e) => { if(!isStarted || e.target.closest('button') || e.target.closest('.menu-container') || e.target.closest('.option-sticker') || e.target.closest('.paper-note')) return; document.getElementById('hint').style.display='none'; handleInteraction(e.touches[0].clientX, e.touches[0].clientY); }, {passive:false});
        window.addEventListener('mousedown', (e) => { if(!isStarted || e.target.closest('button') || e.target.closest('.menu-container') || e.target.closest('.option-sticker') || e.target.closest('.paper-note')) return; document.getElementById('hint').style.display='none'; handleInteraction(e.clientX, e.clientY); });

        initBackground();
        audio.addEventListener('ended', () => { currentTrack = (currentTrack+1)%playlist.length; audio.src = playlist[currentTrack]; audio.play(); });
    </script>
</body>
</html>
