<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>For You ‚ú®</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&family=Inter:wght@400;600&display=swap" rel="stylesheet">

    <style>
        :root {
            --bg: #fdf6f0;
            --text: #5c4d42;
            --paper-lines: rgba(92, 77, 66, 0.08);
            --primary: #d4a373;
            --sticker-front: #fffcf2;
            --sticker-back: #f4e4bc;
        }

        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%;
            background-color: var(--bg);
            background-image: linear-gradient(var(--paper-lines) 1px, transparent 1px);
            background-size: 100% 35px;
            font-family: 'Inter', sans-serif;
            overflow: hidden; touch-action: none;
            transition: background 1s;
            cursor: none; 
        }

        /* --- üñçÔ∏è ROUNDED PENCIL CURSOR --- */
        #doodle-cursor {
            position: fixed; top: 0; left: 0; width: 32px; height: 32px;
            pointer-events: none; z-index: 9999;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' viewBox='0 0 24 24'%3E%3Cpath fill='%23fffcf2' stroke='%232c2c2c' stroke-width='2' stroke-linecap='round' stroke-linejoin='round' d='M5.5 3.5 L 11 17 C 11.2 17.5, 11.8 17.8, 12.3 17.4 L 14.5 12.5 L 19.5 10.5 C 20 10.3, 20.2 9.7, 19.8 9.3 L 6.5 3.2 C 6 2.9, 5.3 3.1, 5.5 3.5 Z'/%3E%3C/svg%3E");
            background-size: contain; background-repeat: no-repeat;
            transform-origin: top left;
            animation: breathe-cursor 2s ease-in-out infinite;
            filter: drop-shadow(2px 2px 1px rgba(0,0,0,0.1));
        }
        @media (pointer: coarse) {
            #doodle-cursor { display: none !important; }
            body, html { cursor: auto; } 
        }
        @keyframes breathe-cursor { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.08); } }
        #doodle-cursor.hovering { animation: none; transform: rotate(-15deg) scale(1.1); }
        #doodle-cursor.clicking { transform: scale(0.9); }
        
        button, .sticker, .tool-btn, .main-menu-btn, .option-sticker, .credits-btn, .nav-btn, a { cursor: none !important; }

        /* --- CURSOR TRAIL --- */
        .cursor-trail {
            position: fixed; pointer-events: none;
            width: 6px; height: 6px;
            background: #d4a373; border-radius: 50%;
            z-index: 9998; opacity: 0.8;
            animation: fadeTrail 0.8s ease-out forwards;
        }
        .cursor-trail.white-mode {
            background: #ffffff !important;
            box-shadow: 0 0 8px 2px rgba(188, 19, 254, 0.6);
        }
        @keyframes fadeTrail { 0% { transform: scale(1); opacity: 0.8; } 100% { transform: scale(0); opacity: 0; margin-top: 10px; } }

        /* --- PAGE TRANSITIONS --- */
        .page-section {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            opacity: 0; pointer-events: none; visibility: hidden;
            transition: opacity 0.6s ease-in-out, visibility 0.6s;
            z-index: 10;
        }
        .page-section.active {
            opacity: 1; pointer-events: auto; visibility: visible; z-index: 20;
        }

        /* --- UI ELEMENTS --- */
        .grain-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 9000; opacity: 0.05; background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E"); }
        
        #page1 { display: flex; flex-direction: column; align-items: center; justify-content: center; }
        #background-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; pointer-events: none; overflow: hidden; }
        .bg-item { position: absolute; top: 110%; opacity: 0; animation: riseUp linear infinite; }
        @keyframes riseUp { 0% { top: 110%; transform: rotate(0deg); opacity: 0; } 10% { opacity: 0.8; } 90% { opacity: 0.8; } 100% { top: -20%; transform: rotate(360deg); opacity: 0; } }

        .invite-text { position: relative; z-index: 30; font-family: 'Patrick Hand', cursive; color: #5c4d42; font-size: 1.8rem; text-align: center; margin-bottom: 70px; line-height: 1.4; max-width: 85%; pointer-events: none; text-shadow: 2px 2px 0px rgba(255,255,255,0.6); }
        
        /* --- üß© BI-DIRECTIONAL PEEL STICKER CSS --- */
        .sticker-wrapper { 
            position: relative; 
            width: 240px; height: 70px; 
            z-index: 40; 
            transform: rotate(-4deg); 
            margin: 0; 
            user-select: none;
        }
        
        /* THE BASE: Stays flat */
        .sticker-flat {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--sticker-front);
            color: #5c4d42;
            border-radius: 50px;
            display: flex; align-items: center; justify-content: center;
            font-family: 'Patrick Hand', cursive; font-size: 1.8rem;
            border: 2px solid #5c4d42;
            box-shadow: 4px 4px 0px rgba(92, 77, 66, 0.1);
            will-change: clip-path;
        }

        /* THE CURL: The peeling part */
        .sticker-curl {
            position: absolute; top: 0; left: 0;
            height: 100%;
            width: 0px; 
            background: var(--sticker-back);
            overflow: hidden;
            box-shadow: 5px 5px 15px rgba(0,0,0,0.15); 
            display: flex; align-items: center; 
            pointer-events: none; 
            z-index: 50;
            will-change: width, transform, left;
        }

        /* Default Left-to-Right Peel Styles */
        .sticker-curl.peel-left {
            border-radius: 50px 0 0 50px; 
            transform-origin: right center;
            transform: translateX(-100%);
            justify-content: flex-end; /* Text on right */
        }
        
        /* Right-to-Left Peel Styles */
        .sticker-curl.peel-right {
            border-radius: 0 50px 50px 0; 
            transform-origin: left center;
            transform: translateX(0); /* Aligned to cut line */
            justify-content: flex-start; /* Text on left */
            box-shadow: -5px 5px 15px rgba(0,0,0,0.15); 
        }

        .peel-content {
            white-space: nowrap;
            color: #d4a373;
            font-family: 'Patrick Hand', cursive; 
            font-size: 1.6rem;
            transform: scaleX(-1); 
            opacity: 0.8;
            margin: 0 25px; /* Padding from edge */
        }

        /* Dynamic Gradient Overlay */
        .sticker-curl::after {
            content: '';
            position: absolute; top: 0; right: 0; bottom: 0; left: 0;
            background: var(--curl-gradient, linear-gradient(to right, rgba(255,255,255,0.2), transparent 40%, rgba(0,0,0,0.1) 80%, rgba(0,0,0,0.25) 100%));
        }

        .doodle-arrow { position: absolute; left: -50px; top: 20px; font-size: 2rem; color: #5c4d42; transform: rotate(-15deg); animation: bounceX 1s infinite alternate; font-family: 'Patrick Hand', cursive; pointer-events: none; }
        .start-star { position: absolute; right: -40px; top: -40px; width: 70px; height: 70px; pointer-events: none; animation: fadeStar 1.5s ease-in-out infinite; }
        
        @keyframes fadeStar { 0%, 100% { opacity: 0.6; transform: scale(0.9) rotate(0deg); } 50% { opacity: 1; transform: scale(1.15) rotate(15deg); } }
        @keyframes bounceX { from { transform: translateX(0) rotate(-15deg); } to { transform: translateX(-10px) rotate(-15deg); } }

        /* UI ELEMENTS */
        .page-title { position: fixed; top: 15%; left: 50%; transform: translate(-50%, -50%); font-family: 'Patrick Hand', cursive; font-size: 2rem; color: #5c4d42; width: 100%; text-align: center; z-index: 50; pointer-events: none; }
        .credits-container { position: fixed; top: 25px; right: 25px; z-index: 2000; display: flex; flex-direction: column; align-items: flex-end; }
        .credits-btn { background: rgba(255,255,255,0.8); border: 1px solid rgba(255,255,255,0.6); padding: 8px 18px; border-radius: 30px; color: var(--text); font-size: 0.75rem; font-weight: 600; text-transform: uppercase; backdrop-filter: blur(8px); }
        .credits-dropdown { margin-top: 15px; background: rgba(255,255,255,0.95); border-radius: 20px; padding: 20px; min-width: 140px; opacity: 0; transform: translateY(-10px); pointer-events: none; transition: 0.3s; position: absolute; top: 40px; right: 0; box-shadow: 0 10px 30px rgba(0,0,0,0.05); }
        .credits-dropdown.show { opacity: 1; transform: translateY(0); pointer-events: auto; }
        .credit-item { margin-bottom: 8px; font-size: 0.7rem; color: #999; border-bottom: 1px solid #eee; padding-bottom: 4px; }
        .credit-name { display: block; color: var(--text); font-weight: 600; font-size: 0.85rem; }
        
        /* MENU */
        .menu-container { position: fixed; bottom: 30px; right: 30px; z-index: 1000; display: flex; flex-direction: column-reverse; align-items: center; gap: 15px; }
        .main-menu-btn { width: 65px; height: 65px; background: #4a3b32; color: #fffcf2; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; box-shadow: 0 8px 20px rgba(74, 59, 50, 0.3); transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); z-index: 1002; pointer-events: auto; }
        .tool-btn { width: 50px; height: 50px; background: rgba(255,255,255,0.9); border: 1px solid white; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 10px rgba(0,0,0,0.05); backdrop-filter: blur(5px); opacity: 0; transform: translateY(20px) scale(0.8); transition: all 0.3s cubic-bezier(0.4, 0.0, 0.2, 1); pointer-events: auto; }
        .nav-group { position: fixed; bottom: 30px; left: 30px; z-index: 1000; display: flex; gap: 15px; align-items: center; pointer-events: auto; }
        .nav-btn { 
            background: white; border: 2px solid var(--text); padding: 10px 20px; 
            border-radius: 20px; font-family: 'Patrick Hand', cursive; font-size: 1.2rem;
            cursor: pointer; transition: transform 0.2s; box-shadow: 3px 3px 0px rgba(92, 77, 66, 0.1);
        }
        .nav-btn:hover { transform: scale(1.05); }
        .nav-btn:active { transform: scale(0.95); }

        /* INTERMEDIATE PAGE */
        .intermediate-text { position: relative; z-index: 10; font-family: 'Patrick Hand', cursive; font-size: 1.8rem; color: var(--text); text-align: center; margin-bottom: 50px; padding: 0 20px; max-width: 85%; line-height: 1.5; }
        #page4 { display: flex; flex-direction: column; align-items: center; justify-content: center; }
        
        /* RAIN ELEMENTS */
        .falling-item { position: absolute; top: -100px; pointer-events: none; }
        .falling-vector { font-family: 'Patrick Hand', cursive; color: rgba(92, 77, 66, 0.3); font-size: 1.5rem; z-index: 45; animation: fallDownVector linear infinite; }
        .falling-envelope { z-index: 45; font-size: 2rem; opacity: 0.3; animation: fallDownEnvelope linear infinite; }
        .falling-envelope-celebration { z-index: 45; font-size: 1.8rem; opacity: 0.4; animation: fallDownCelebration linear infinite; }
        .falling-text {
            position: absolute; top: -50px; font-family: 'Patrick Hand', cursive; 
            color: #d8b4e2; font-size: 0.9rem; opacity: 0.5; pointer-events: none; z-index: 55; 
            white-space: nowrap; animation: fallDownText linear infinite;
        }
        
        /* --- üéûÔ∏è VIDEO BACKGROUND --- */
        #outro-video-bg {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            object-fit: cover; z-index: 1; display: none; pointer-events: none; opacity: 0;
            transition: opacity 1.5s ease-in-out;
        }
        
        /* --- CONFETTI --- */
        .confetti { position: absolute; pointer-events: none; z-index: 9000; font-size: 1.5rem; }

        /* --- HOVER SPARKLE EFFECT --- */
        .hover-sparkle {
            position: absolute; pointer-events: none;
            width: 50px; height: 50px; 
            background-image: url('spark.png'); background-size: contain; background-repeat: no-repeat;
            z-index: 60; animation: sparkleOut 0.8s ease-out forwards; mix-blend-mode: screen; 
        }
        @keyframes sparkleOut {
            0% { opacity: 1; transform: scale(0.5) translate(0, 0); }
            100% { opacity: 0; transform: scale(1.2) translate(var(--tx), var(--ty)); }
        }

        @keyframes fallDownVector { 0% { top: -10%; transform: rotate(0deg); } 100% { top: 110%; transform: rotate(180deg); } }
        @keyframes fallDownEnvelope { 0% { top: -10%; transform: rotate(0deg); } 100% { top: 110%; transform: rotate(20deg); } }
        @keyframes fallDownCelebration { 0% { top: -10%; transform: rotate(0deg); opacity: 0; } 20% { opacity: 0.4; } 100% { top: 110%; transform: rotate(-10deg); opacity: 0; } }
        @keyframes fallDownText { 0% { top: -10%; opacity: 0; } 15% { opacity: 0.5; } 85% { opacity: 0.5; } 100% { top: 110%; opacity: 0; } }

        .final-glow { font-family: 'Patrick Hand', cursive; font-size: 3rem; color: #fff; text-align: center; line-height: 1.4; text-shadow: 0 0 15px rgba(255, 255, 255, 0.2), 0 0 30px rgba(188, 19, 254, 0.4); animation: softPulse 5s ease-in-out infinite; position: relative; z-index: 60; padding: 0 20px; }
        .music-icon { display: inline-block; width: 55px; height: 55px; vertical-align: middle; margin-left: 10px; margin-bottom: 5px; animation: spinMusic 4s linear infinite; }
        @keyframes spinMusic { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        @keyframes softPulse { 0%, 100% { transform: scale(1); opacity: 0.95; } 50% { transform: scale(1.02); opacity: 1; } }
        
        .question-text { position: relative; z-index: 50; font-family: 'Patrick Hand', cursive; font-size: 2.5rem; color: var(--text); text-align: center; margin-bottom: 50px; max-width: 80%; line-height: 1.2; animation: breathe 3s ease-in-out infinite; }
        @keyframes breathe { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }
        .option-group { position: relative; z-index: 50; display: flex; flex-wrap: wrap; justify-content: center; max-width: 320px; gap: 15px; }
        .option-sticker { padding: 12px 25px; border: 2px solid var(--text); background: white; font-family: 'Patrick Hand', cursive; font-size: 1.3rem; border-radius: 255px 15px 225px 15px / 15px 225px 15px 255px; transition: transform 0.2s; box-shadow: 3px 3px 0px rgba(0,0,0,0.1); user-select: none; }
        .option-sticker:active { transform: scale(0.9) !important; }
        #btn-nah { position: relative; transition: top 0.2s, left 0.2s; } 
        #final-msg { margin-top: 40px; font-family: 'Patrick Hand', cursive; font-size: 1.6rem; color: #d4a373; text-align: center; min-height: 50px; padding: 0 20px; position:relative; z-index:50; }
        
        /* FLOWERS */
        .flower { position: absolute; pointer-events: none; transform: translate(-50%, -50%) scale(0); animation: bloom 0.8s cubic-bezier(0.34, 1.56, 0.64, 1) forwards; filter: drop-shadow(4px 4px 6px rgba(0,0,0,0.1)); z-index: 2000; }
        @keyframes bloom { to { transform: translate(-50%, -50%) scale(1) rotate(var(--r)); } }
        .bubble { position: absolute; background: #fff; padding: 10px 20px; border-radius: 2px 20px 20px 20px; font-family: 'Patrick Hand', cursive; font-size: 1.2rem; color: var(--text); pointer-events: none; animation: floatUpBubble 4s ease-out forwards; z-index: 100; white-space: nowrap; box-shadow: 2px 4px 15px rgba(0,0,0,0.05); transform: rotate(-2deg); }
        @keyframes floatUpBubble { 0% { opacity: 0; transform: translate(-50%, 10px) rotate(-2deg); } 15% { opacity: 1; transform: translate(-50%, 0) rotate(-2deg); } 100% { opacity: 0; transform: translate(-50%, -120px) rotate(5deg); } }

        /* MODALS */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.3); z-index: 9000; display: none; align-items: center; justify-content: center; backdrop-filter: blur(3px); opacity: 0; transition: opacity 0.3s; }
        .modal-overlay.open { opacity: 1; }
        .paper-note { background: #fffcf2; width: 80%; max-width: 300px; padding: 30px; border-radius: 2px; box-shadow: 0 10px 30px rgba(0,0,0,0.15); font-family: 'Patrick Hand', cursive; font-size: 1.3rem; color: #4a3b32; line-height: 1.6; transform: rotate(-2deg); position: relative; }
        .close-note { position: absolute; top: 10px; right: 15px; font-size: 1.5rem; color: #aaa; cursor: pointer; }
        .secret-box { background: #fff; padding: 25px; border-radius: 20px; text-align: center; font-family: 'Inter', sans-serif; box-shadow: 0 10px 30px rgba(0,0,0,0.2); width: 250px; }
        .secret-input { width: 80%; padding: 10px; margin: 15px 0; border: 2px solid #eee; border-radius: 10px; font-family: 'Inter', sans-serif; outline: none; }
        .secret-btn { background: #d4a373; color: white; border: none; padding: 8px 20px; border-radius: 15px; font-weight: 600; cursor: pointer; }
        #hint { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); pointer-events: none; color: #d4a373; letter-spacing: 4px; font-size: 0.8rem; z-index: 10; display: none; }
        #music-status { position: fixed; top: 30px; left: 25px; font-size: 0.7rem; color: #d4a373; letter-spacing: 2px; font-weight: 600; text-transform: uppercase; display: none; }
        .typing-dots::after { content: '...'; animation: dotAnim 1.5s infinite steps(4); display: inline-block; width: 15px; text-align: left; }
        @keyframes dotAnim { 0% { content: ''; } 25% { content: '.'; } 50% { content: '..'; } 75% { content: '...'; } }
    </style>
</head>
<body>
    <div id="doodle-cursor"></div>
    <div class="grain-overlay"></div>

    <video id="outro-video-bg" muted loop playsinline>
        <source src="video.mp4" type="video/mp4">
    </video>

    <div id="page1" class="page-section active">
        <div id="background-layer"></div>
        <h1 class="invite-text">This is an invitation to my<br>possibly future friend : )</h1>
        
        <div class="sticker-wrapper" id="peel-wrapper">
            <div class="doodle-arrow">‚ûú</div>
            <img src="star.png" class="start-star">
            
            <div class="sticker-flat" id="sticker-base">Start Here</div>
            
            <div class="sticker-curl peel-left" id="sticker-curl">
                <div class="peel-content">Opening...</div>
            </div>
        </div>
        
        <div style="margin-top: 20px; color:#aaa; font-size:0.7rem; font-family:'Inter'; text-transform:uppercase; letter-spacing:1px; opacity:0.6;">&lt;&lt; PEEL TO OPEN</div>
    </div>

    <div id="page2" class="page-section" onclick="handleOutsideClick(event)">
        <div class="nav-group">
            <button class="nav-btn" onclick="navigateTo('page1')">Back</button>
            <button class="nav-btn" onclick="navigateTo('page3')">Next ‚ûú</button>
        </div>
        <h2 class="page-title">What i know about u</h2>
        <div class="credits-container">
            <button class="credits-btn" onclick="toggleCredits(event)">Credits</button>
            <div class="credits-dropdown" id="creditsMenu">
                <div class="credit-item"><span class="credit-name">Faizan</span>Director</div>
                <div class="credit-item"><span class="credit-name">Gemini Pro</span>Writer</div>
                <div class="credit-item"><span class="credit-name">Time</span>lgta hai bhai</div>
            </div>
        </div>
        <div class="menu-container" id="menuContainer" onmouseenter="openMenu()" onmouseleave="closeMenu()">
            <div class="main-menu-btn" onclick="toggleMenuMobile(event)">+</div>
            <div class="tool-list">
                <div class="tool-btn" id="broom-btn" onclick="toggleEraser(event)">
                    <svg viewBox="0 0 24 24"><path d="M12 2L2 12l4 4 10-10-4-4zM2 12l10 10 4-4-10-10-4 4z"></path><path d="M16 16l4 4"></path></svg>
                </div>
                <div class="tool-btn" onclick="openLetter()"><svg viewBox="0 0 24 24"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg></div>
                <div class="tool-btn" onclick="openSecretLock()"><svg viewBox="0 0 24 24"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg></div>
                <div class="tool-btn" onclick="takeScreenshotMode()"><svg viewBox="0 0 24 24"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path><circle cx="12" cy="13" r="4"></circle></svg></div>
            </div>
        </div>
    </div>

    <div id="page3" class="page-section" style="display:flex; flex-direction:column; align-items:center; justify-content:center;">
        <div class="nav-group"><button class="nav-btn" onclick="navigateTo('page2')">Back</button><button class="nav-btn" onclick="navigateTo('page4')">Ask ‚ûú</button></div>
        <p class="intermediate-text">So that's all i know about u & i bet theres more , but before that i got a question to ask u....</p>
    </div>

    <div id="page4" class="page-section">
        <div class="nav-group" id="q-nav"><button class="nav-btn" onclick="navigateTo('page3')">Back</button></div>
        <div id="q-content">
            <h1 class="question-text">Can we be friends?</h1>
            <div class="option-group">
                <div class="option-sticker" id="btn-yes" style="transform: rotate(-2deg);" onclick="answer('yes')" onmouseenter="startSparkles()" onmouseleave="stopSparkles()">Yess!</div>
                <div class="option-sticker" onclick="answer('think')">I will think</div>
                <div class="option-sticker" onclick="answer('donno')">Umm donno</div>
                <div class="option-sticker" id="btn-nah" onmouseover="moveNah()" onclick="moveNah()">Nah...</div>
            </div>
        </div>
        <div id="final-msg"></div>
    </div>

    <div id="letter-modal" class="modal-overlay" onclick="closeModal('letter-modal')">
        <div class="paper-note" onclick="event.stopPropagation()">
            <span class="close-note" onclick="closeModal('letter-modal')">&times;</span><p>Hey,<br><br>Just wanted to make something as cool as you.<br>Hope this brings a smile to your face!<br><br>- Faizan</p>
        </div>
    </div>
    <div id="secret-lock-modal" class="modal-overlay" onclick="closeModal('secret-lock-modal')">
        <div class="secret-box" onclick="event.stopPropagation()">
            <span class="close-note" onclick="closeModal('secret-lock-modal')">&times;</span><h3>Top Secret ü§´</h3><p style="font-size: 0.8rem; color: #888;">Enter Password:</p><input type="text" id="secret-pass" class="secret-input" placeholder="???"><button class="secret-btn" onclick="checkPassword()">Unlock</button>
        </div>
    </div>
    <div id="secret-content-modal" class="modal-overlay" onclick="closeModal('secret-content-modal')">
        <div class="paper-note" style="background: #e3f2fd;" onclick="event.stopPropagation()"><span class="close-note" onclick="closeModal('secret-content-modal')">&times;</span><h3 style="text-align:center;">üéâ Access Granted!</h3><p>(This space is waiting for your secret content...)</p></div>
    </div>

    <div id="hint">TAP & DRAG</div><div id="music-status"></div><audio id="bg-audio"></audio>

    <script>
        // --- 1. CURSOR LOGIC ---
        const cursor = document.getElementById('doodle-cursor');
        document.addEventListener('mousemove', (e) => {
            cursor.style.left = e.clientX + 'px'; cursor.style.top = e.clientY + 'px';
            spawnTrail(e.clientX, e.clientY);
            const hovered = document.elementFromPoint(e.clientX, e.clientY);
            if (hovered && (hovered.tagName === 'BUTTON' || hovered.classList.contains('sticker-flat') || hovered.closest('.tool-btn') || hovered.classList.contains('option-sticker') || hovered.closest('.nav-btn'))) {
                cursor.classList.add('hovering');
            } else { cursor.classList.remove('hovering'); }
        });
        document.addEventListener('mousedown', () => cursor.classList.add('clicking'));
        document.addEventListener('mouseup', () => cursor.classList.remove('clicking'));
        document.addEventListener('touchmove', (e) => { const t = e.touches[0]; spawnTrail(t.clientX, t.clientY); });

        function spawnTrail(x, y) {
            const p3 = document.getElementById('page3');
            const p4 = document.getElementById('page4');
            if (!p3.classList.contains('active') && !p4.classList.contains('active')) return;
            const trail = document.createElement('div');
            trail.className = 'cursor-trail';
            if (p4.classList.contains('active') && document.getElementById('q-content').style.display === 'none') {
                trail.classList.add('white-mode');
            }
            trail.style.left = x + 'px'; trail.style.top = y + 'px';
            document.body.appendChild(trail);
            setTimeout(() => trail.remove(), 800);
        }

        // --- 2. BI-DIRECTIONAL PEEL LOGIC ---
        const peelWrapper = document.getElementById('peel-wrapper');
        const peelBase = document.getElementById('sticker-base');
        const peelCurl = document.getElementById('sticker-curl');
        
        let isPeeling = false;
        let startPeelX = 0;
        let startPeelY = 0;
        let peelProgress = 0;
        let isRightPeel = false;

        function startPeel(e) {
            if (isStarted) return;
            isPeeling = true;
            const cx = e.type.includes('touch') ? e.touches[0].clientX : e.clientX;
            const cy = e.type.includes('touch') ? e.touches[0].clientY : e.clientY;
            startPeelX = cx; startPeelY = cy;
            
            // Detect side: click on right half -> peel left
            const rect = peelWrapper.getBoundingClientRect();
            isRightPeel = (cx - rect.left) > (rect.width / 2);

            peelBase.style.transition = 'none';
            peelCurl.style.transition = 'none';
            
            // Set up initial state for direction
            if (isRightPeel) {
                peelCurl.classList.remove('peel-left');
                peelCurl.classList.add('peel-right');
                peelCurl.style.setProperty('--curl-gradient', 'linear-gradient(to left, rgba(255,255,255,0.2), transparent 40%, rgba(0,0,0,0.1) 80%, rgba(0,0,0,0.25) 100%)');
            } else {
                peelCurl.classList.remove('peel-right');
                peelCurl.classList.add('peel-left');
                peelCurl.style.setProperty('--curl-gradient', 'linear-gradient(to right, rgba(255,255,255,0.2), transparent 40%, rgba(0,0,0,0.1) 80%, rgba(0,0,0,0.25) 100%)');
            }

            if (audio.paused) { audio.src = playlist[0]; audio.play(); }
        }

        function movePeel(e) {
            if (!isPeeling || isStarted) return;
            const cx = e.type.includes('touch') ? e.touches[0].clientX : e.clientX;
            const cy = e.type.includes('touch') ? e.touches[0].clientY : e.clientY;
            
            let deltaX = cx - startPeelX;
            let deltaY = cy - startPeelY;
            
            // Calculate progress based on direction
            let progress = 0;
            if (isRightPeel) {
                if (deltaX > 0) return; // Can only pull left
                progress = Math.min(Math.abs(deltaX) / 200, 1);
            } else {
                if (deltaX < 0) return; // Can only pull right
                progress = Math.min(deltaX / 200, 1);
            }
            
            progress = Math.pow(progress, 0.8); // Resistance
            
            // Skew: dragging down = skew positive (left peel) or negative (right peel)
            let skew = deltaY * 0.1;
            skew = Math.max(Math.min(skew, 20), -20);

            updatePeelVisuals(progress, skew);
            peelProgress = progress;
        }

        function endPeel() {
            if (!isPeeling) return;
            isPeeling = false;
            
            peelBase.style.transition = 'clip-path 0.4s ease-out';
            peelCurl.style.transition = 'all 0.4s ease-out';

            if (peelProgress > 0.6) {
                // Success
                isStarted = true;
                if (isRightPeel) {
                    peelBase.style.clipPath = `inset(0 250px 0 0)`;
                    peelCurl.style.transform = `translateX(100%) rotate(10deg) scale(1.1)`;
                } else {
                    peelBase.style.clipPath = `inset(0 0 0 250px)`;
                    peelCurl.style.transform = `translateX(-100%) rotate(-10deg) scale(1.1)`;
                }
                peelCurl.style.opacity = '0';
                setTimeout(() => navigateTo('page2'), 500);
            } else {
                // Snap back
                peelBase.style.clipPath = isRightPeel ? `inset(0 0 0 0)` : `inset(0 0 0 0)`;
                peelCurl.style.width = `0px`;
                // Reset transform
                if (isRightPeel) {
                    peelCurl.style.left = '240px'; 
                    peelCurl.style.transform = `translateX(0) skewY(0deg)`;
                } else {
                    peelCurl.style.left = '0px';
                    peelCurl.style.transform = `translateX(-100%) skewY(0deg)`;
                }
            }
        }

        function updatePeelVisuals(p, skew) {
            const width = 240; 
            const peelAmount = p * width;
            
            if (isRightPeel) {
                // Clip from right
                peelBase.style.clipPath = `inset(0 ${peelAmount}px 0 0)`;
                // Curl starts at cut line and goes right
                peelCurl.style.width = `${peelAmount}px`;
                peelCurl.style.left = `${width - peelAmount}px`;
                peelCurl.style.transform = `translateX(0) skewY(${-skew}deg)`;
            } else {
                // Clip from left
                peelBase.style.clipPath = `inset(0 0 0 ${peelAmount}px)`;
                // Curl starts at cut line and goes left
                peelCurl.style.width = `${peelAmount}px`;
                peelCurl.style.left = `${peelAmount}px`;
                peelCurl.style.transform = `translateX(-100%) skewY(${skew}deg)`;
            }
        }

        peelWrapper.addEventListener('mousedown', startPeel);
        window.addEventListener('mousemove', movePeel);
        window.addEventListener('mouseup', endPeel);
        peelWrapper.addEventListener('touchstart', startPeel);
        window.addEventListener('touchmove', movePeel);
        window.addEventListener('touchend', endPeel);


        // --- 3. STANDARD LOGIC & FLOWERS RESTORED ---
        const playlist = ['song1.mp3', 'song2.mp3']; 
        let currentTrack = 0;
        const colors = ['#f8ad9d', '#fbc4ab', '#ffdab9', '#ece4db', '#d8e2dc'];
        const notes = ["Independent person ‚úã", "Never sleeps.. ü¶â", "Possibly Batwoman? ü§î", "top-tier friend üèÜ", "elite music taste üòå", "10/10 human üåü", "insane vibes ‚ú®", "Nonchalant fr üò¨", "Caring ü´Ç"];
        const rainTexts = ["the design wasn't nonchalant enough", "I think I'm online ü§î", "do u like it?", "Aaaa.....", "shaba bakhair", "what time is it rn?", "ahh i forgot turn the lights on", "hows the song"];
        const aestheticVectors = ["|", "*", "¬∑", "~", "¬∞", "+"];
        const audio = document.getElementById('bg-audio');
        let isStarted = false;
        let isEraserActive = false;

        document.body.addEventListener('click', () => {
            if (audio.paused && !document.getElementById('page4').classList.contains('active')) {
                audio.src = playlist[0];
                audio.play().catch(e => console.log("Waiting...", e));
            }
        }, { once: true });

        function initBackground() {
            const container = document.getElementById('background-layer');
            for(let i=0; i<50; i++) {
                const el = document.createElement('div'); el.className = 'bg-item';
                const size = Math.random() * 40 + 30; 
                if(Math.random()>0.5) el.innerHTML = `<svg width="${size}" height="${size}" viewBox="0 0 100 100"><circle cx="50" cy="50" r="25" fill="${colors[Math.floor(Math.random()*colors.length)]}" opacity="0.5"/></svg>`;
                else el.innerHTML = `<svg width="${size}" height="${size}" viewBox="0 0 100 100" fill="none" stroke="#d4a373" stroke-width="2"><path d="M10,50 Q50,10 90,50"/></svg>`;
                el.style.left = Math.random() * 100 + 'vw';
                el.style.animationDuration = (Math.random() * 15 + 15) + 's';
                el.style.animationDelay = (Math.random() * -30) + 's'; 
                container.appendChild(el);
            }
        }

        function navigateTo(pageId) {
            document.querySelectorAll('.page-section').forEach(p => p.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
            if(pageId !== 'page2') document.querySelectorAll('.flower').forEach(f => f.remove());
            if(pageId === 'page1') {
                isStarted = false; 
                peelBase.style.clipPath = 'inset(0 0 0 0)';
                peelCurl.style.width = '0px'; peelCurl.style.opacity = '1';
                document.getElementById('hint').style.display = 'none';
            }
            if(pageId === 'page2') {
                document.getElementById('hint').style.display = 'block';
                document.getElementById('music-status').style.display = 'block';
                document.getElementById('music-status').innerHTML = "Vibing<span class='typing-dots'></span> üéµ";
                document.querySelectorAll('.falling-item').forEach(i => i.remove());
            }
            if(pageId === 'page3') { document.getElementById('hint').style.display = 'none'; initVectorRain(); }
            if(pageId === 'page4') { initFinalRain(); }
        }

        // --- HOVER SPARKLES ---
        let sparkleInterval;
        const btnYes = document.getElementById('btn-yes');
        function startSparkles() { if(sparkleInterval) return; sparkleInterval = setInterval(() => { createHoverSparkle(btnYes); }, 20); }
        function stopSparkles() { clearInterval(sparkleInterval); sparkleInterval = null; }
        function createHoverSparkle(btn) { 
            if(!btn) return; 
            const rect = btn.getBoundingClientRect(); 
            const sparkle = document.createElement('div'); 
            sparkle.className = 'hover-sparkle'; 
            sparkle.style.left = (rect.left + Math.random()*rect.width) + 'px'; 
            sparkle.style.top = (rect.top + Math.random()*rect.height) + 'px'; 
            const angle = Math.random()*Math.PI*2; const v=80+Math.random()*80; 
            sparkle.style.setProperty('--tx', Math.cos(angle)*v+'px'); 
            sparkle.style.setProperty('--ty', Math.sin(angle)*v+'px'); 
            document.body.appendChild(sparkle); setTimeout(()=>sparkle.remove(),800); 
        }

        // --- RAIN & ANSWER ---
        function initVectorRain() {
            const c = document.getElementById('page3'); c.querySelectorAll('.falling-item').forEach(o=>o.remove());
            for(let i=0; i<40; i++) { 
                const v = document.createElement('div'); v.className = 'falling-item falling-vector';
                v.innerText = aestheticVectors[Math.floor(Math.random()*aestheticVectors.length)];
                v.style.left = Math.random()*100+'vw'; v.style.animationDuration=(Math.random()*8+5)+'s'; v.style.animationDelay=(Math.random()*5)+'s';
                c.appendChild(v);
            }
        }
        function initFinalRain() {
            const c = document.getElementById('page4'); c.querySelectorAll('.falling-item').forEach(o=>o.remove());
            for(let i=0; i<25; i++) {
                const e = document.createElement('div'); e.className = 'falling-item falling-envelope'; e.innerText = '‚úâÔ∏è';
                e.style.left = Math.random()*100+'vw'; e.style.animationDuration=(Math.random()*5+8)+'s'; e.style.animationDelay=(Math.random()*5)+'s';
                c.appendChild(e);
            }
        }
        function startCelebrationRain() {
            const c = document.getElementById('page4'); c.querySelectorAll('.falling-envelope').forEach(e=>e.style.opacity='0');
            for(let i=0; i<15; i++) {
                const e = document.createElement('div'); e.className = 'falling-item falling-envelope-celebration'; e.innerText = '‚úâÔ∏è';
                e.style.left = Math.random()*100+'vw'; e.style.animationDuration=(Math.random()*10+10)+'s';
                c.appendChild(e);
            }
            for(let i=0; i<rainTexts.length; i++) {
                const t = document.createElement('div'); t.className = 'falling-text'; t.innerText = rainTexts[i];
                t.style.left = (Math.random()>0.5?Math.random()*15:85+Math.random()*15)+'vw';
                t.style.animationDuration=(Math.random()*10+15)+'s'; t.style.animationDelay=(Math.random()*5)+'s';
                c.appendChild(t);
            }
        }

        function answer(type) {
            const msg = document.getElementById('final-msg');
            const container = document.getElementById('page4');
            const video = document.getElementById('outro-video-bg');
            document.getElementById('q-nav').style.display='none'; stopSparkles();

            if(type === 'yes') {
                container.style.background = "transparent"; document.body.style.backgroundColor = "black";
                document.getElementById('q-content').style.display='none';
                video.style.display='block'; video.play(); setTimeout(()=>video.style.opacity='1',50);
                
                msg.innerHTML = '<h1 class="final-glow">We‚Äôre officially friends now <img src="music.png" class="music-icon"></h1>';
                audio.pause(); const cel = new Audio('Song3.mp3'); let vol=0.2; cel.volume=vol; cel.play();
                const fade = setInterval(()=>{ if(vol<1){ vol=Math.min(vol+0.3,1); cel.volume=vol; } else clearInterval(fade); }, 2000);
                cel.onended = function() { new Audio('song4.mp3').play(); };
                startCelebrationRain(); explodeConfetti();
            } else { msg.innerText = "Take your time... üòå"; msg.style.color="#d4a373"; }
        }

        function explodeConfetti() {
            const p = ['üå∏', '‚úâÔ∏è', '‚ù§Ô∏è', '‚ú®', 'üíå', 'üëç'];
            for(let i=0; i<300; i++) {
                const c = document.createElement('div'); c.className = 'confetti'; c.innerText = p[Math.floor(Math.random()*p.length)];
                c.style.left='50%'; c.style.top='50%'; c.style.fontSize=Math.random()*20+10+'px';
                document.body.appendChild(c);
                const dx=(Math.random()-0.5)*window.innerWidth*1.5; const dy=(Math.random()-0.5)*window.innerHeight*1.5;
                const anim = c.animate([{transform:'translate(0,0)', opacity:1}, {transform:`translate(${dx}px, ${dy}px) rotate(${Math.random()*720}deg)`, opacity:0}], {duration:1500+Math.random()*2000, easing:'cubic-bezier(0.25,1,0.5,1)'});
                anim.onfinish = ()=>c.remove();
            }
        }

        // --- COMMON FUNCTIONS ---
        function moveNah() { const b=document.getElementById('btn-nah'); b.style.position='fixed'; b.style.left=Math.random()*(window.innerWidth-120)+'px'; b.style.top=Math.random()*(window.innerHeight-100)+'px'; }
        function openMenu() { document.getElementById('menuContainer').classList.add('menu-open'); }
        function closeMenu() { document.getElementById('menuContainer').classList.remove('menu-open'); }
        function toggleMenuMobile(e) { e.stopPropagation(); document.getElementById('menuContainer').classList.toggle('menu-open'); }
        function handleOutsideClick(e) { if (!e.target.closest('.menu-container')) document.getElementById('menuContainer').classList.remove('menu-open'); }
        function toggleEraser(e) { if(e)e.stopPropagation(); isEraserActive=!isEraserActive; const b=document.getElementById('broom-btn'); if(isEraserActive){b.classList.add('active-tool');document.getElementById('hint').innerText="TAP FLOWER TO ERASE";}else{b.classList.remove('active-tool');document.getElementById('hint').innerText="TAP & DRAG";} }
        function openLetter() { const m=document.getElementById('letter-modal'); m.style.display='flex'; setTimeout(()=>m.classList.add('open'),10); }
        function openSecretLock() { const m=document.getElementById('secret-lock-modal'); m.style.display='flex'; setTimeout(()=>m.classList.add('open'),10); }
        function closeModal(id) { const m=document.getElementById(id); m.classList.remove('open'); setTimeout(()=>m.style.display='none',300); }
        function checkPassword() { if(document.getElementById('secret-pass').value==="Im nonchalant") alert("Unlocked!"); else alert("Wrong!"); }
        function takeScreenshotMode() { document.getElementById('page2').style.opacity='0'; setTimeout(()=>document.getElementById('page2').style.opacity='1',4000); }
        function toggleCredits(e) { e.stopPropagation(); document.getElementById('creditsMenu').classList.toggle('show'); }
        window.addEventListener('click', (e) => { if (!e.target.closest('.credits-container')) document.getElementById('creditsMenu').classList.remove('show'); });

        // --- FLOWERS RESTORED ---
        function handleInteraction(x, y) {
            if(!document.getElementById('page2').classList.contains('active')) return;
            if(isEraserActive) {
                document.querySelectorAll('.flower').forEach(f => {
                    const r = f.getBoundingClientRect();
                    if(Math.hypot(x-(r.left+r.width/2), y-(r.top+r.height/2)) < 50) f.remove();
                }); return;
            }
            createFlower(x, y);
        }
        function createFlower(x, y) {
            const color = colors[Math.floor(Math.random() * colors.length)];
            const size = Math.random() * 40 + 50; 
            const f = document.createElement('div'); f.className = 'flower';
            f.style.left = x + 'px'; f.style.top = y + 'px'; f.style.setProperty('--r', Math.random()*360+'deg');
            // Restored the multi-circle flower SVG
            f.innerHTML = `<svg width="${size}" height="${size}" viewBox="0 0 100 100"><circle cx="50" cy="30" r="25" fill="${color}" stroke="rgba(0,0,0,0.05)"/><circle cx="50" cy="70" r="25" fill="${color}" stroke="rgba(0,0,0,0.05)"/><circle cx="30" cy="50" r="25" fill="${color}" stroke="rgba(0,0,0,0.05)"/><circle cx="70" cy="50" r="25" fill="${color}" stroke="rgba(0,0,0,0.05)"/><circle cx="50" cy="50" r="12" fill="#fffcf2"/><path d="M50 30 L50 70 M30 50 L70 50" stroke="rgba(0,0,0,0.1)" stroke-width="1.2"/></svg>`;
            document.body.appendChild(f);
            if(Math.random()<0.3) {
                const b=document.createElement('div'); b.className='bubble'; b.style.left=x+'px'; b.style.top=(y-60)+'px';
                b.innerText = notes[Math.floor(Math.random()*notes.length)]; document.body.appendChild(b); setTimeout(()=>b.remove(),4000);
            }
            if(document.querySelectorAll('.flower').length>30) document.querySelector('.flower').remove();
        }
        let lastX=0, lastY=0;
        window.addEventListener('touchmove', (e) => { if(!isStarted) return; const t=e.touches[0]; if(Math.hypot(t.clientX-lastX, t.clientY-lastY)>20) { handleInteraction(t.clientX, t.clientY); lastX=t.clientX; lastY=t.clientY; } }, {passive:false});
        window.addEventListener('mousemove', (e) => { if(!isStarted || e.buttons===0) return; if(Math.hypot(e.clientX-lastX, e.clientY-lastY)>20) { handleInteraction(e.clientX, e.clientY); lastX=e.clientX; lastY=e.clientY; } });
        window.addEventListener('touchstart', (e) => { if(!isStarted || e.target.closest('button')) return; handleInteraction(e.touches[0].clientX, e.touches[0].clientY); });
        window.addEventListener('mousedown', (e) => { if(!isStarted || e.target.closest('button')) return; handleInteraction(e.clientX, e.clientY); });

        initBackground();
        audio.addEventListener('ended', () => { currentTrack = (currentTrack+1)%playlist.length; audio.src = playlist[currentTrack]; audio.play(); });
    </script>
</body>
</html>
